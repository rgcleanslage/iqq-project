# Migration Guide: v7 to v8

**Date**: February 20, 2026  
**Status**: Generated from Code Analysis  
**Auto-Generated**: Yes

## Overview

This migration guide was automatically generated by analyzing code changes between v7 and v8.

## Summary of Changes

This guide documents the differences found across all services.


## Service Changes

### Package Service

## Changed Files in package Service

### Recent Changes
- fix: update stageVariables type to match AWS APIGatewayProxyEvent (b301c25)
- fix: use standard APIGatewayProxyEvent type (already has stageVariables) (fd7ff2d)
- fix: allow stageVariables to be null for TypeScript compatibility (0d7cd74)
- fix: use event.stageVariables instead of event.requestContext.stageVariables (6d21324)
- fix: add TypeScript type for stageVariables in requestContext (dc55536)
- feat: read version metadata from API Gateway stage variables (5e7c889)
- Update Cognito client ID mapping for test client (533cab1)
- feat: remove version-policy.json, use env vars for deprecation headers (02d46b3)
- feat: add v4 to version policy (#3) (097cb81)
- fix: update tests to match handler signature (removed context parameter) (79792e3)
- feat: add API versioning with response builder and version headers (4974818)
- Fix Lambda permissions with proper dependencies and parameterized API Gateway ID (3088e36)
- feat: add service deployment workflow (c43593c)
- Add API Gateway Lambda permissions to SAM template (0dbe8df)
- Add Makefile for SAM build (0a241d3)
- Add Lambda aliases to SAM template for API versioning (e0a72a5)
- feat: add service deployment workflow (b51062b)
- feat: add service deployment workflow (48149e6)
- feat: add version policy configuration (5c28f62)
- feat: add service deployment workflow (d40892c)

### API Handler Changes

#### Handler Signature
```typescript
```

### Data Model Changes

#### package.ts
```typescript
export interface QuoteRequest {
  productCode: string;
  coverageType: string;
  vehicleValue: number;
  term: string;
}

export interface ProviderQuote {
  provider: string;
  providerId: string;
  providerRating: string;
  quoteId: string;
  premium: number;
  coverageAmount: number;
  termMonths: number;
  timestamp: string;
}

export interface PackageResponse {
  packageId: string;
  packageName: string;
  packageType: string;
  request: QuoteRequest;
  providerQuotes: ProviderQuote[];
  pricing: {
    basePrice: number;
    discountPercentage: number;
    totalPrice: number;
    currency: string;
    averagePremium: number;
  };
  bestQuote: {
    provider: string;
    providerId: string;
    premium: number;
    savings: number;
  } | null;
  summary: {
    totalQuotes: number;
    successfulQuotes: number;
    failedProviders: number;
    errors: Array<{
      provider: string;
      error: string;
    }>;
  };
  metadata: {
    timestamp: string;
    version: string;
    correlationId: string;
```

### Dependency Changes

```json
{
  "@aws-sdk/client-api-gateway": "^3.992.0",
  "@aws-sdk/client-sfn": "^3.700.0",
  "aws-xray-sdk-core": "^3.5.0"
}
```


### Lender Service

## Changed Files in lender Service

### Recent Changes
- fix: update stageVariables type to match AWS APIGatewayProxyEvent (9e7e55a)
- fix: use standard APIGatewayProxyEvent type (already has stageVariables) (f78e8c5)
- fix: allow stageVariables to be null for TypeScript compatibility (ed9e4cb)
- fix: use event.stageVariables instead of event.requestContext.stageVariables (fbb1010)
- fix: add TypeScript type for stageVariables in requestContext (fe5d75e)
- feat: read version metadata from API Gateway stage variables (a19a119)
- feat: remove version-policy.json, use env vars for deprecation headers (7dfe6df)
- fix: remove unused context parameter from handler signature (e25a8fa)
- feat: add API versioning with response builder and version headers (335bd54)
- Fix Lambda permissions with proper dependencies and parameterized API Gateway ID (da373ef)
- feat: add service deployment workflow (6921546)
- Add API Gateway Lambda permissions to SAM template (aa247b6)
- Add Makefile for SAM build (2517de2)
- Add Lambda aliases to SAM template for API versioning (50049ee)
- feat: add service deployment workflow (6c6f935)
- feat: add service deployment workflow (8adb07d)
- feat: add version policy configuration (f5f1999)
- feat: add service deployment workflow (c0a3c0f)
- Lower coverage thresholds to match current coverage (117205f)
- Add package-lock.json and fix test coverage generation in CI/CD (e556d80)

### API Handler Changes

#### Handler Signature
```typescript
```

### Data Model Changes

#### lender.ts
```typescript
/**
 * Lender domain models
 */

export interface LenderResponse {
  lenderId: string;
  lenderName: string;
  lenderType: 'Captive' | 'Independent' | 'Bank' | 'Credit Union';
  contactInfo: ContactInfo;
  productsOffered: string[];
  ratingInfo: RatingInfo;
  metadata: Metadata;
}

export interface ContactInfo {
  phone: string;
  email: string;
  website: string;
}

export interface RatingInfo {
  creditRating: string;
  yearsInBusiness: number;
  customerSatisfactionScore: number;
}

export interface Metadata {
  timestamp: string;
  version: string;
  correlationId: string;
}
```

### Dependency Changes

```json
{
  "aws-xray-sdk-core": "^3.5.0"
}
```


### Product Service

## Changed Files in product Service

### Recent Changes
- fix: update stageVariables type to match AWS APIGatewayProxyEvent (36fa218)
- fix: use standard APIGatewayProxyEvent type (already has stageVariables) (4784993)
- fix: allow stageVariables to be null for TypeScript compatibility (1d50d10)
- fix: use event.stageVariables instead of event.requestContext.stageVariables (5a8a37b)
- fix: add TypeScript type for stageVariables in requestContext (536e381)
- feat: read version metadata from API Gateway stage variables (674190c)
- feat: remove version-policy.json, use env vars for deprecation headers (5f722cf)
- fix: remove unused context parameter from handler signature (5cb6e95)
- feat: add API versioning with response builder and version headers (6a31946)
- Fix Lambda permissions with proper dependencies and parameterized API Gateway ID (503367c)
- feat: add service deployment workflow (21ddf38)
- Add API Gateway Lambda permissions to SAM template (07ade33)
- Add Makefile for SAM build (8866acd)
- Add Lambda aliases to SAM template for API versioning (9c9f2bb)
- feat: add service deployment workflow (23a87c5)
- feat: add service deployment workflow (2e330a7)
- feat: add version policy configuration (4b909f3)
- feat: add service deployment workflow (1702043)
- Lower coverage thresholds to match current coverage (7770620)
- Fix test coverage generation in CI/CD (796cd78)

### API Handler Changes

#### Handler Signature
```typescript
```

### Data Model Changes

#### product.ts
```typescript
/**
 * Product domain models
 */

export interface ProductResponse {
  productId: string;
  productName: string;
  productType: 'MBP' | 'GAP' | 'Vehicle Depreciation Protection' | 'Auto Deductible';
  description: string;
  coverage: CoverageDetails;
  pricing: PricingDetails;
  providers: ProviderInfo[];
  metadata: Metadata;
}

export interface CoverageDetails {
  coverageType: string;
  coverageLimit: number;
  deductible: number;
  term: string;
  exclusions: string[];
}

export interface PricingDetails {
  basePremium: number;
  adminFee: number;
  taxRate: number;
  totalPremium: number;
  currency: string;
}

export interface ProviderInfo {
  providerId: string;
  providerName: string;
  rating: string;
  available: boolean;
}

export interface Metadata {
  timestamp: string;
  version: string;
  correlationId: string;
}
```

### Dependency Changes

```json
{
  "aws-xray-sdk-core": "^3.5.0"
}
```


### Document Service

## Changed Files in document Service

### Recent Changes
- fix: update stageVariables type to match AWS APIGatewayProxyEvent (1373886)
- fix: use standard APIGatewayProxyEvent type (already has stageVariables) (b6708cc)
- fix: allow stageVariables to be null for TypeScript compatibility (4fe5774)
- fix: use event.stageVariables instead of event.requestContext.stageVariables (e6ce871)
- fix: add TypeScript type for stageVariables in requestContext (8dc5dbc)
- feat: read version metadata from API Gateway stage variables (4add039)
- feat: remove version-policy.json, use env vars for deprecation headers (a62e754)
- fix: remove unused context parameter from handler signature (1d58f7c)
- feat: add API versioning with response builder and version headers (504e72b)
- Fix Lambda permissions with proper dependencies and parameterized API Gateway ID (46d9622)
- feat: add service deployment workflow (ae70680)
- Add API Gateway Lambda permissions to SAM template (6053d45)
- Add Makefile for SAM build (30901b6)
- Add Lambda aliases to SAM template for API versioning (9e99000)
- feat: add service deployment workflow (79533ce)
- feat: add service deployment workflow (b96b453)
- feat: add version policy configuration (fe79cc4)
- feat: add service deployment workflow (f801737)
- Lower coverage thresholds to match current coverage (3ad67f1)
- Add package-lock.json and fix test coverage generation in CI/CD (d171ab3)

### API Handler Changes

#### Handler Signature
```typescript
```

### Data Model Changes

#### document.ts
```typescript
/**
 * Document domain models
 */

export interface DocumentResponse {
  documentId: string;
  documentName: string;
  documentType: 'Policy' | 'Quote' | 'Certificate' | 'Endorsement' | 'Claim';
  status: 'Draft' | 'Pending' | 'Approved' | 'Issued' | 'Archived';
  content: DocumentContent;
  metadata: DocumentMetadata;
}

export interface DocumentContent {
  format: 'PDF' | 'JSON' | 'XML';
  size: number;
  url: string;
  checksum: string;
}

export interface DocumentMetadata {
  createdAt: string;
  updatedAt: string;
  createdBy: string;
  version: string;
  correlationId: string;
  tags: string[];
}
```

### Dependency Changes

```json
{
  "aws-xray-sdk-core": "^3.5.0"
}
```



## Breaking Changes Analysis

Based on the code analysis above, review the following areas for potential breaking changes:

### API Request/Response Changes

- Review handler signatures for parameter changes
- Check data models for schema modifications
- Verify response structure consistency

### Dependency Updates

- Review dependency version changes
- Check for deprecated package usage
- Verify compatibility with existing integrations

## Migration Steps

### Step 1: Review Code Changes

Review all service changes documented above and assess impact on your integration.

### Step 2: Update API Endpoints

Update your API endpoint URLs from v7 to v8:

\`\`\`
# Before
https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v7/package

# After
https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8/package
\`\`\`

### Step 3: Test Integration

Test all endpoints with your integration:

\`\`\`bash
# Test package endpoint
curl -i "https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8/package?productCode=MBP" \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "x-api-key: $API_KEY"

# Test lender endpoint
curl -i "https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8/lender?lenderId=LENDER-001" \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "x-api-key: $API_KEY"

# Test product endpoint
curl -i "https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8/product?productId=PROD-001" \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "x-api-key: $API_KEY"

# Test document endpoint
curl -i "https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8/document" \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "x-api-key: $API_KEY"
\`\`\`

### Step 4: Verify Version Headers

Ensure you're receiving correct version headers:

\`\`\`bash
curl -i "https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8/package?productCode=MBP" \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "x-api-key: $API_KEY" | grep -i "x-api-version"

# Expected: x-api-version: v8
\`\`\`

## Code Examples

### JavaScript/TypeScript

\`\`\`typescript
// Update base URL
const API_BASE_URL = 'https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8';

const response = await fetch(\`\${API_BASE_URL}/package\`, {
  headers: {
    'Authorization': \`Bearer \${token}\`,
    'x-api-key': apiKey
  }
});

// Check version
const apiVersion = response.headers.get('X-API-Version');
console.log('API Version:', apiVersion); // Should be: v8
\`\`\`

### Python

\`\`\`python
import requests

# Update base URL
API_BASE_URL = 'https://r8ukhidr1m.execute-api.us-east-1.amazonaws.com/v8'

response = requests.get(
    f'{API_BASE_URL}/package',
    headers={
        'Authorization': f'Bearer {token}',
        'x-api-key': api_key
    }
)

# Check version
api_version = response.headers.get('X-API-Version')
print(f'API Version: {api_version}')  # Should be: v8
\`\`\`

## Rollback Plan

If you encounter issues:

1. Revert endpoint URLs to v7
2. Monitor application stability
3. Report issues to API team
4. Plan remediation with updated migration guide

## Support

- **Documentation**: https://docs.iqq.com/api
- **API Reference**: https://docs.iqq.com/api/reference
- **GitHub Issues**: https://github.com/rgcleanslage/iqq-project/issues

## Migration Checklist

- [ ] Review all service changes above
- [ ] Identify breaking changes
- [ ] Update endpoint URLs
- [ ] Update request/response handling (if needed)
- [ ] Test in development
- [ ] Verify version headers
- [ ] Deploy to staging
- [ ] Perform integration tests
- [ ] Deploy to production
- [ ] Monitor for issues

---

**Generated**: February 20, 2026  
**Method**: Automated code analysis  
**Note**: This guide was auto-generated. Please review and enhance with specific breaking changes and examples.
